<%- include('../partials/header') %>
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/pages/index.css">

<div class="main-content">
  <div class="row">
    <div class="col-lg-9 col-md-8">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><%= post.title %></h1>
        <% if (typeof req !== 'undefined' && req.session && req.session.user && req.session.user.id === post.user_id) { %>
          <div class="d-flex gap-3">
            <a href="/posts/<%= post.id %>/edit" class="text-primary text-decoration-none">
              <i class="bi bi-pencil"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
            </a>
            <form action="/posts/delete/<%= post.id %>" method="post" onsubmit="return confirmDelete(event)" class="d-inline">
              <button type="submit" class="btn btn-link text-danger text-decoration-none p-0 m-0">
                <i class="bi bi-trash"></i> ‡∏•‡∏ö
              </button>
            </form>
          </div>
        <% } %>
        
      </div>
      <p class="text-muted">
        ‡πÇ‡∏î‡∏¢ <%= post.username %> | 
        ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: <%= post.category_name %> |
        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <%= new Date(post.created_at).toLocaleDateString('th-TH') %>
      </p>
      <div class="content">
        <%- post.content %>
      </div>

      <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ -->
      <div class="card my-4">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="mb-0">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£</h5>
          <% if (typeof req !== 'undefined' && req.session && req.session.user && (req.session.user.role === 'admin' || req.session.user.role === 'leader')) { %>
            <form class="d-flex gap-2" action="/posts/<%= post.id %>/line" method="POST">
              <input type="url" name="line_group_url" value="<%= post.line_group_url || '' %>" placeholder="https:// (LINE/Discord/Facebook/‡∏≠‡∏∑‡πà‡∏ô‡πÜ)" class="form-control" style="max-width:360px" required>
              <button class="btn btn-outline-primary btn-sm">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
            </form>
          <% } %>
        </div>
        <div class="card-body">
          <% if (post.line_group_url) { %>
            <a href="<%= post.line_group_url %>" target="_blank" rel="noopener" class="btn btn-success">
              <i class="bi bi-link-45deg"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£
            </a>
            <% if (typeof req !== 'undefined' && req.session && req.session.user && (req.session.user.role === 'admin')) { %>
              <form action="/posts/<%= post.id %>/line/delete" method="POST" class="d-inline ms-2" onsubmit="return confirm('‡∏•‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå LINE ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏ä‡∏°‡∏£‡∏°‡∏ô‡∏µ‡πâ?');">
                <button class="btn btn-outline-danger btn-sm">‡∏•‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
              </form>
            <% } %>
          <% } else { %>
            <div class="text-muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏° LINE ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏°‡∏£‡∏°‡∏ô‡∏µ‡πâ</div>
          <% } %>
        </div>
      </div>

      <% if (typeof req !== 'undefined' && req.session && req.session.user && 
            (req.session.user.id === post.user_id || (isMember && memberStatus === 'approved'))) { %>
        <!-- Club Management Section -->
        <div class="club-management mt-5">
          <!-- ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£ -->
          <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0">üì¢ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£</h5>
                             <% if (typeof req !== 'undefined' && req.session && req.session.user && 
                     (req.session.user.role === 'admin' || req.session.user.role === 'leader')) { %>
                 <a href="/posts/<%= post.id %>/news/add" class="btn btn-primary btn-sm">
                   <i class="bi bi-plus-circle"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£
                 </a>
               <% } %>
            </div>
            <div class="card-body">
              <div class="news-list" style="max-height: 400px; overflow-y: auto;">
                <% if (news && news.length > 0) { %>
                  <% news.forEach(item => { %>
                    <div class="news-item mb-3 p-3 border rounded">
                      <div class="d-flex justify-content-between align-items-start">
                        <div>
                          <h6 class="mb-1"><%= item.title %></h6>
                          <p class="text-muted small mb-2">
                            ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: <%= item.category %> | 
                            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <%= new Date(item.created_at).toLocaleDateString('th-TH') %>
                          </p>
                          <p class="mb-2"><%= item.content %></p>
                        </div>
                        <% if (typeof req !== 'undefined' && req.session && req.session.user && 
                              (req.session.user.role === 'admin' || req.session.user.role === 'leader')) { %>
                          <div class="d-flex gap-2">
                            <a href="/posts/<%= post.id %>/news/<%= item.id %>/edit" class="news-btn-fix btn-primary-outline">
                              <i class="bi bi-pencil"></i>
                            </a>
                            <form action="/posts/<%= post.id %>/news/<%= item.id %>/delete" method="POST" class="d-inline-block">
                              <button type="submit" class="news-btn-fix btn-danger-outline" onclick="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')">
                                <i class="bi bi-trash"></i>
                              </button>
                            </form>
                          </div>
                        <% } %>
                      </div>
                    </div>
                  <% }); %>
                <% } else { %>
                  <p class="text-muted mb-0">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£</p>
                <% } %>
              </div>
            </div>
          </div>

          <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ö‡∏°‡∏≤ -->
          <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ö‡∏°‡∏≤</h5>
              <% if (typeof req !== 'undefined' && req.session && req.session.user && 
                    (req.session.user.role === 'admin' || req.session.user.role === 'leader')) { %>
                <a href="/posts/<%= post.id %>/files/upload" class="btn btn-primary btn-sm">
                  <i class="fas fa-upload"></i> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
                </a>
              <% } %>
            </div>
            <div class="card-body">
              <div class="news-list" style="max-height: 400px; overflow-y: auto;">
                <% if (files && files.length > 0) { %>
                  <% files.forEach(file => {
                    // Determine the appropriate icon based on file extension
                    let fileIconClass = 'fas fa-file'; // Default icon
                    const fileExtension = file.filename.split('.').pop().toLowerCase();
                    if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-image';
                    } else if (['pdf'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-pdf';
                    } else if (['doc', 'docx'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-word';
                    } else if (['xls', 'xlsx'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-excel';
                    } else if (['ppt', 'pptx'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-powerpoint';
                    } else if (['zip', 'rar', '7z'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-archive';
                    } else if (['txt'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-alt';
                    } else if (['mp3', 'wav', 'ogg'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-audio';
                    } else if (['mp4', 'avi', 'mov'].includes(fileExtension)) {
                      fileIconClass = 'fas fa-file-video';
                    }
                  %>
                    <div class="news-item mb-3 p-3 border rounded">
                      <div class="d-flex justify-content-between align-items-start">
                        <div class="flex-grow-1 me-3">
                          <a href="/uploads/<%= file.filename %>" class="text-decoration-none" download>
                            <p class="mb-1 text-primary">
                              <i class="<%= fileIconClass %> "></i>
                              <%= file.display_name || file.originalname %>
                            </p>
                          </a>
                          <% if (file.description) { %>
                            <p class="mb-2"><%= file.description %></p>
                          <% } %>
                          <small class="text-muted d-block mt-1">
                            ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠ <%= new Date(file.created_at).toLocaleString('th-TH', { 
                              year: 'numeric', 
                              month: 'long', 
                              day: 'numeric',
                              hour: '2-digit',
                              minute: '2-digit'
                            }) %>
                          </small>
                        </div>
                        <% if (typeof req !== 'undefined' && req.session && req.session.user && 
                              (req.session.user.role === 'admin' || req.session.user.role === 'leader')) { %>
                          <div class="d-flex gap-2">
                            <form action="/posts/<%= post.id %>/files/<%= file.id %>/delete" method="POST" class="d-inline-block">
                              <button type="submit" class="news-btn-fix btn-danger-outline" onclick="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ?')">
                                <i class="bi bi-trash"></i>
                              </button>
                            </form>
                          </div>
                        <% } %>
                      </div>
                    </div>
                  <% }); %>
                <% } else { %>
                  <p class="text-muted mb-0 p-3">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ö‡∏°‡∏≤</p>
                <% } %>
              </div>
            </div>
          </div>

          

          <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà -->
          <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0">üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h5>
              <div class="d-flex gap-2">
                <% if (typeof req !== 'undefined' && req.session && req.session.user && (req.session.user.role === 'admin' || req.session.user.role === 'leader')) { %>
                  <a href="/booking/new" class="btn btn-outline-primary btn-sm">‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</a>
                  <a href="/events/new?postId=<%= post.id %>" class="btn btn-primary btn-sm">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</a>
                <% } %>
              </div>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table">
                  <thead>
                    <tr>
                      <th>‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á</th>
                      <th>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</th>
                      <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
                      <th>‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% if (bookings && bookings.length > 0) { %>
                      <% bookings.forEach(b => { %>
                        <tr>
                          <td><%= b.reserver_name %></td>
                          <td><%= b.book_name %></td>
                          <td><%= b.place_name %></td>
                          <td>
                            <%= new Date(b.date).toLocaleDateString('th-TH') %>
                            ‡πÄ‡∏ß‡∏•‡∏≤ <%= b.time %>
                          </td>
                        </tr>
                      <% }) %>
                    <% } else { %>
                      <tr>
                        <td colspan="4" class="text-muted">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</td>
                      </tr>
                    <% } %>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      <% } %>

      <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ -->
      <% if (typeof req !== 'undefined' && req.session && req.session.user && 
            isMember && memberStatus === 'pending') { %>
        <div class="alert alert-warning mt-4">
          <div class="d-flex align-items-center">
            <i class="bi bi-clock me-2"></i>
            <div>
              <strong>‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°</strong>
              <p class="mb-0 mt-1">‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°</p>
            </div>
          </div>
        </div>
      <% } %>
    </div>

    <div class="col-lg-3 col-md-4">
      <% if (typeof req !== 'undefined' && req.session && req.session.user) { %>
        <% if (req.session.user.role === 'leader') { %>
          <!-- Leader ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ -->
          <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0">üìù ‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</h5>
              <% if (pendingMembers.length > 0) { %>
                <form action="/posts/<%= post.id %>/approve-all" method="POST" class="d-inline" onsubmit="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')">
                  <button type="submit" class="btn btn-success btn-sm">
                    <i class="bi bi-check-all"></i> ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                  </button>
                </form>
              <% } %>
            </div>
            <div class="card-body">
              <% if (pendingMembers.length > 0) { %>
                <% pendingMembers.forEach(member => { %>
                  <div class="member-request mb-3 p-3 border rounded">
                    <p class="mb-1">
                      <strong><%= member.f_name %> <%= member.l_name %></strong><br>
                      ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <%= member.student_id %><br>
                      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£: <%= new Date(member.created_at).toLocaleDateString('th-TH') %>
                    </p>
                    <div class="d-flex gap-2">
                      <form action="/posts/<%= post.id %>/approve/<%= member.id %>" method="POST" class="d-inline">
                        <button type="submit" class="btn btn-success btn-sm">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button>
                      </form>
                      <form action="/posts/<%= post.id %>/reject/<%= member.id %>" method="POST" class="d-inline">
                        <button type="submit" class="btn btn-danger btn-sm">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</button>
                      </form>
                    </div>
                  </div>
                <% }); %>
              <% } else { %>
                <p class="text-muted mb-0">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</p>
              <% } %>
            </div>
          </div>
        <% } %>
      <% } %>

      <!-- Card ‡∏Ç‡∏ß‡∏≤: ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏° -->
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="mb-0"> ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°</h5>
        </div>
        <div class="card-body">
          <!-- ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏• (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ä‡∏°‡∏£‡∏°) -->
          <div class="mb-3">
            <h6 class="text-primary mb-2">
              <i class="bi bi-shield-check"></i> ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•
            </h6>
            <div class="d-flex align-items-center">
              <div class="flex-shrink-0">
                <i class="bi bi-person-circle fs-2 text-primary"></i>
              </div>
              <div class="flex-grow-1 ms-3">
                <h6 class="mb-1"><%= post.f_name %> <%= post.l_name %></h6>
                <p class="text-muted mb-0">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏¥‡∏™‡∏¥‡∏ï: <%= post.student_id %></p>
                <small class="badge bg-primary">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</small>
              </div>
            </div>
          </div>
          <!-- ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏° (leader) -->
          <hr class="my-3">
          <div>
            <h6 class="text-success mb-2">
              <i class="bi bi-star"></i> ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°
            </h6>
            <% 
            const clubLeaders = approvedMembers.filter(member => member.role === '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°' || member.role === 'leader');
            if (clubLeaders.length > 0) { 
              clubLeaders.forEach(leader => { %>
                <div class="d-flex align-items-center mb-2">
                  <div class="flex-shrink-0">
                    <i class="bi bi-person-circle fs-2 text-success"></i>
                  </div>
                  <div class="flex-grow-1 ms-3">
                    <h6 class="mb-1"><%= leader.f_name %> <%= leader.l_name %></h6>
                    <p class="text-muted mb-0">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏¥‡∏™‡∏¥‡∏ï: <%= leader.student_id %></p>
                    <small class="badge bg-success">‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°</small>
                  </div>
                </div>
            <% }) 
            } else { %>
              <div class="text-muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°</div>
            <% } %>
          </div>
        </div>
      </div>

      <!-- ‡∏¢‡πâ‡∏≤‡∏¢: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‡πÑ‡∏õ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤‡πÉ‡∏ï‡πâ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏° -->
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="mb-0">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h5>
        </div>
        <div class="card-body">
          <div class="member-management">
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏¥‡∏™‡∏¥‡∏ï</th>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                    <% if (req.session.user.role === 'admin' || req.session.user.role === 'leader') { %>
                    <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    <% } %>
                  </tr>
                </thead>
                <tbody>
                  <% approvedMembers.forEach(member => { %>
                    <tr>
                      <td><%= member.f_name %></td>
                      <td><%= member.student_id %></td>
                      <td>
                        <% if (member.role === 'admin') { %>
                          <span class="badge bg-primary">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</span>
                        <% } else if (member.role === 'leader') { %>
                          <span class="badge bg-success">‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°</span>
                        <% } else { %>
                          <span class="badge bg-secondary">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</span>
                        <% } %>
                      </td>
                      <% if (req.session.user.role === 'admin' || req.session.user.role === 'leader') { %>
                      <% if (member.role !== 'leader' && member.role !== 'admin') { %>
                        <td>
                          <button class="btn btn-danger btn-sm remove-member" data-member-id="<%= member.id %>" data-member-name="<%= member.f_name %> <%= member.l_name %>"><i class="bi bi-person-x"></i> ‡∏•‡∏ö</button>
                        </td>
                      <% } %>
                      <% } %>
                    </tr>
                  <% }); %>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <% if (typeof req !== 'undefined' && req.session && req.session.user) { %>
        <% if (req.session.user.id !== post.user_id) { %>
          <!-- ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ -->
          <% if (!isMember) { %>
            <form action="/posts/<%= post.id %>/join" method="POST">
              <button type="submit" class="btn btn-primary w-100">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°</button>
            </form>
          <% } else { %>
            <div class="alert alert-info">
              <% if (memberStatus === 'pending') { %>
                <div class="d-flex justify-content-between align-items-center">
                  <span><i class="bi bi-clock me-2"></i>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>
                  <form action="/posts/<%= post.id %>/cancel-join" method="POST" class="d-inline" onsubmit="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£?')">
                    <button type="submit" class="btn btn-outline-danger btn-sm">
                      <i class="bi bi-x-circle"></i> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£
                    </button>
                  </form>
                </div>
                <small class="text-muted d-block mt-2">
                  ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß
                </small>
              <% } else if (memberStatus === 'approved') { %>
                <div class="d-flex align-items-center">
                  <i class="bi bi-check-circle me-2 text-success"></i>
                  <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß</span>
                </div>
              <% } else if (memberStatus === 'rejected') { %>
                <div class="d-flex align-items-center">
                  <i class="bi bi-x-circle me-2 text-danger"></i>
                  <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏ñ‡∏π‡∏Å‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</span>
                </div>
              <% } %>
            </div>
          <% } %>
        <% } %>
      <% } else { %>
        <div class="alert alert-warning">
          ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏°
        </div>
      <% } %>
    </div>
  </div>
</div>

<!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå -->
<div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="uploadModalLabel">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form action="/posts/<%= post.id %>/files" method="POST" enctype="multipart/form-data">
          <div class="mb-3">
            <label for="file" class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</label>
            <input type="file" class="form-control" id="file" name="file" required>
            <small class="text-muted">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB</small>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button type="submit" class="btn btn-primary">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ -->
<div class="modal fade" id="statsModal" tabindex="-1" aria-labelledby="statsModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="statsModalLabel">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="memberStats">
          <!-- ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£ -->
<div class="modal fade" id="newsModal" tabindex="-1" aria-labelledby="newsModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="newsModalLabel">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="newsForm" action="/posts/<%= post.id %>/news" method="POST">
          <input type="hidden" name="news_id" id="newsId">
          <div class="mb-3">
            <label for="newsTitle" class="form-label">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ç‡πà‡∏≤‡∏ß</label>
            <input type="text" class="form-control" id="newsTitle" name="title" required>
          </div>
          <div class="mb-3">
            <label for="newsContent" class="form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
            <textarea class="form-control" id="newsContent" name="content" rows="4" required></textarea>
          </div>
          <div class="mb-3">
            <label for="newsCategory" class="form-label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
            <select class="form-select" id="newsCategory" name="category" required>
              <option value="‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
              <option value="‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</option>
              <option value="‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</option>
            </select>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button type="submit" class="btn btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
// Add confirmation dialog for delete
function confirmDelete(event) {
  if (!confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏ä‡∏°‡∏£‡∏°‡∏ô‡∏µ‡πâ?')) {
    event.preventDefault();
  }
}

// ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
document.addEventListener('DOMContentLoaded', function() {
  const removeButtons = document.querySelectorAll('.remove-member');
  removeButtons.forEach(button => {
    button.addEventListener('click', async function() {
      const memberId = this.dataset.memberId;
      const memberName = this.dataset.memberName;
      const postId = window.location.pathname.split('/')[2];

      if (confirm(`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ${memberName} ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ä‡∏°‡∏£‡∏°?`)) {
        try {
          const response = await fetch(`/posts/${postId}/members/${memberId}/remove`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            }
          });
          
          const data = await response.json();
          
          if (data.success) {
            // ‡∏•‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            this.closest('tr').remove();
            alert('‡∏•‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ä‡∏°‡∏£‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
          } else {
            alert(data.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å');
          }
        } catch (error) {
          alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å');
          console.error('Error:', error);
        }
      }
    });
  });
});

// ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£
document.addEventListener('DOMContentLoaded', function() {
  const editButtons = document.querySelectorAll('.edit-news');
  const newsModal = document.getElementById('newsModal');
  const newsForm = document.getElementById('newsForm');
  const newsIdInput = document.getElementById('newsId');
  const newsTitleInput = document.getElementById('newsTitle');
  const newsContentInput = document.getElementById('newsContent');
  const newsCategoryInput = document.getElementById('newsCategory');
  const modalTitle = newsModal.querySelector('.modal-title');

  editButtons.forEach(button => {
    button.addEventListener('click', function() {
      const newsId = this.dataset.newsId;
      const title = this.dataset.title;
      const content = this.dataset.content;
      const category = this.dataset.category;

      modalTitle.textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£';
      newsIdInput.value = newsId;
      newsTitleInput.value = title;
      newsContentInput.value = content;
      newsCategoryInput.value = category;
      newsForm.action = `/posts/${window.location.pathname.split('/')[2]}/news/${newsId}/edit`;

      new bootstrap.Modal(newsModal).show();
    });
  });

  // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
  newsModal.addEventListener('show.bs.modal', function(event) {
    if (!event.relatedTarget) return; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
    modalTitle.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£';
    newsForm.reset();
    newsIdInput.value = '';
    newsForm.action = `/posts/${window.location.pathname.split('/')[2]}/news`;
  });
});

// ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
document.addEventListener('DOMContentLoaded', function() {
  const uploadModal = document.getElementById('uploadModal');
  const uploadForm = uploadModal.querySelector('form');
  const fileInput = document.getElementById('file');

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
  fileInput.addEventListener('change', function() {
    const file = this.files[0];
    if (file) {
      const maxSize = 10 * 1024 * 1024; // 10MB
      if (file.size > maxSize) {
        alert('‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 10MB)');
        this.value = ''; // ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
      }
    }
  });

  // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
  uploadForm.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const postId = window.location.pathname.split('/')[2];

    fetch(`/posts/${postId}/files`, {
      method: 'POST',
      body: formData
    })
    .then(response => {
      if (response.ok) {
        window.location.reload(); // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà
      } else {
        throw new Error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå');
      }
    })
    .catch(error => {
      alert(error.message);
    });
  });
});

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå
function deleteFile(fileId) {
  if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ?')) {
    fetch(`/posts/<%= post.id %>/files/${fileId}/delete`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      }
    })
    .then(response => {
      if (response.ok) {
        window.location.reload();
      } else {
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå');
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå');
    });
  }
}
</script>

